import{Aa as v,Ba as u,Ca as C,Da as h,Ea as w,Fa as E,Q as P,Ta as R,Ua as I,X as d,Y as l,Za as z,ka as s,na as r,qa as M,ra as m,sa as x,ta as p,ua as o,va as c,wa as O,xa as b,ya as f,za as y}from"./chunk-UUYZMWBI.js";var T=["scratchCanvas"],L=["prizeImage"];function S(g,e){if(g&1&&(o(0,"div",10)(1,"p"),h(2,"\u{1F3AE} Congratulations! Copy this code to Xbox Live:"),c(),o(3,"div",11),h(4),c()()),g&2){let t=y();s(4),w(t.winningCode())}}var D=class g{canvasRef;imageRef;canvasWidth=300;canvasHeight=400;images=[{src:"assets/images/winner.jpeg",message:"\u{1F389} Congratulations! You Won!",width:this.canvasWidth,height:this.canvasHeight},{src:"assets/images/try-again.jpeg",message:"Try Again! Good Luck Next Time!",width:this.canvasWidth,height:this.canvasHeight},{src:"assets/images/trololo.jpeg",message:"\u{1F61C} Trolololo! Better luck next time!",width:this.canvasWidth,height:this.canvasHeight}];ctx;isDrawing=!1;lastX=0;lastY=0;revealThreshold=.8;totalPixels=0;scratchedPixels=0;selectedImage=r("");message=r("");isRevealed=r(!1);currentImage=r(this.getRandomImage());winningCode=r("");showWinningCode=r(!1);ngAfterViewInit(){let e=this.canvasRef.nativeElement.getContext("2d",{willReadFrequently:!0});if(!e){console.error("Could not initialize canvas context");return}this.ctx=e,this.initializeGame()}initializeGame(){let e=this.getRandomImage();this.currentImage.set(e),this.message.set(e.message),this.isRevealed.set(!1)}getRandomImage(){return this.images[Math.floor(Math.random()*this.images.length)]}onImageLoad(){let e=this.canvasRef.nativeElement,t=e.getContext("2d",{willReadFrequently:!0});if(!t){console.error("Could not initialize canvas context");return}this.ctx=t,e.width=this.canvasWidth,e.height=this.canvasHeight,this.ctx.fillStyle="#888888",this.ctx.fillRect(0,0,e.width,e.height),this.totalPixels=e.width*e.height,this.setupEventListeners()}setupEventListeners(){let e=this.canvasRef.nativeElement;e.addEventListener("mousedown",this.startDrawing.bind(this)),e.addEventListener("mousemove",this.scratch.bind(this)),e.addEventListener("mouseup",this.stopDrawing.bind(this)),e.addEventListener("mouseleave",this.stopDrawing.bind(this)),e.addEventListener("touchstart",this.handleTouch.bind(this)),e.addEventListener("touchmove",this.handleTouch.bind(this)),e.addEventListener("touchend",this.stopDrawing.bind(this))}startDrawing(e){this.isDrawing=!0,[this.lastX,this.lastY]=[e.offsetX,e.offsetY]}scratch(e){this.isDrawing&&(this.ctx.globalCompositeOperation="destination-out",this.ctx.beginPath(),this.ctx.lineWidth=40,this.ctx.lineCap="round",this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(e.offsetX,e.offsetY),this.ctx.stroke(),[this.lastX,this.lastY]=[e.offsetX,e.offsetY],this.checkRevealThreshold())}handleTouch(e){e.preventDefault();let t=e.touches[0],n=this.canvasRef.nativeElement.getBoundingClientRect(),i=t.clientX-n.left,a=t.clientY-n.top;e.type==="touchstart"?(this.isDrawing=!0,[this.lastX,this.lastY]=[i,a]):e.type==="touchmove"&&this.scratch({offsetX:i,offsetY:a})}stopDrawing(){this.isDrawing=!1}checkRevealThreshold(){let e=this.ctx.getImageData(0,0,this.canvasRef.nativeElement.width,this.canvasRef.nativeElement.height);this.scratchedPixels=0;for(let t=0;t<e.data.length;t+=4)e.data[t+3]===0&&this.scratchedPixels++;this.scratchedPixels/this.totalPixels>this.revealThreshold&&this.reveal()}reveal(){this.ctx.clearRect(0,0,this.canvasRef.nativeElement.width,this.canvasRef.nativeElement.height),this.isRevealed.set(!0),this.currentImage().message.includes("Congratulations")&&(this.winningCode.set(this.generateWinningCode()),this.showWinningCode.set(!0))}generateWinningCode(){let n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="";for(let a=0;a<3;a++){for(let _=0;_<5;_++){let k=Math.floor(Math.random()*n.length);i+=n[k]}a<2&&(i+="-")}return i}resetGame(){this.initializeGame(),this.onImageLoad(),this.showWinningCode.set(!1)}static \u0275fac=function(t){return new(t||g)};static \u0275cmp=P({type:g,selectors:[["app-scratch-game"]],viewQuery:function(t,n){if(t&1&&(v(T,5),v(L,5)),t&2){let i;u(i=C())&&(n.canvasRef=i.first),u(i=C())&&(n.imageRef=i.first)}},standalone:!0,features:[E],decls:14,vars:13,consts:[["prizeImage",""],["scratchCanvas",""],[1,"scratch-container"],["class","winning-code",4,"ngIf"],[1,"game-wrapper"],[1,"message"],[1,"try-again",3,"click"],[1,"canvas-wrapper"],[1,"prize-content"],["priority","","alt","Prize",1,"prize-image",3,"load","ngSrc","width","height"],[1,"winning-code"],[1,"code"]],template:function(t,n){if(t&1){let i=b();o(0,"div",2),M(1,S,5,1,"div",3),o(2,"div",4)(3,"div",5)(4,"h2"),h(5),c(),o(6,"button",6),f("click",function(){return d(i),l(n.resetGame())}),h(7,"Try Again"),c()(),o(8,"div",7)(9,"div",8)(10,"img",9,0),f("load",function(){return d(i),l(n.onImageLoad())}),c()(),O(12,"canvas",null,1),c()()()}t&2&&(s(),m("ngIf",n.showWinningCode()),s(2),p("visible",n.isRevealed()),s(2),w(n.message()),s(3),x("width",n.canvasWidth,"px")("height",n.canvasHeight,"px"),s(),p("revealed",n.isRevealed()),s(),m("ngSrc",n.currentImage().src)("width",n.currentImage().width)("height",n.currentImage().height))},dependencies:[I,R,z],styles:["[_nghost-%COMP%]{display:block;width:100%;min-height:100vh;background:linear-gradient(135deg,#1a1a2e,#16213e)}.scratch-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:2rem}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]{position:relative;background:#ffffff1a;border-radius:20px;padding:2rem;box-shadow:0 8px 32px #0000004d;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1)}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(.9);background:#fffffff2;padding:2rem;border-radius:15px;text-align:center;opacity:0;visibility:hidden;transition:all .3s ease;z-index:10;box-shadow:0 4px 15px #0003}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:translate(-50%,-50%) scale(1)}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:1.5rem;font-size:1.5rem}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .try-again[_ngcontent-%COMP%]{padding:.8rem 1.5rem;font-size:1rem;background:linear-gradient(135deg,#f6d365,#fda085);border:none;border-radius:25px;color:#fff;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .try-again[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 15px #fda08566}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .try-again[_ngcontent-%COMP%]:active{transform:translateY(0)}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .canvas-wrapper[_ngcontent-%COMP%]{position:relative;border-radius:15px;overflow:hidden}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .canvas-wrapper[_ngcontent-%COMP%]   .prize-content[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#fff}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .canvas-wrapper[_ngcontent-%COMP%]   .prize-content[_ngcontent-%COMP%]   .prize-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .canvas-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{position:absolute;top:0;left:0;cursor:pointer;border-radius:15px;touch-action:none}@keyframes _ngcontent-%COMP%_reveal{0%{opacity:1}to{opacity:0}}@media (max-width: 768px){.scratch-container[_ngcontent-%COMP%], .scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]{padding:1rem}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{width:90%;padding:1.5rem}.scratch-container[_ngcontent-%COMP%]   .game-wrapper[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}}.winning-code[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:linear-gradient(135deg,#4caf50,#45a049);color:#fff;padding:1rem;text-align:center;z-index:1000;animation:_ngcontent-%COMP%_slideDown .5s ease-out;box-shadow:0 2px 10px #0003}.winning-code[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;margin-bottom:.5rem}.winning-code[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{font-family:monospace;font-size:1.5rem;font-weight:700;background:#fff3;padding:.5rem;border-radius:4px;letter-spacing:2px;-webkit-user-select:all;user-select:all;cursor:pointer}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%)}to{transform:translateY(0)}}"]})};export{D as ScratchGameComponent};
